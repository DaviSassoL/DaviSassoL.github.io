<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Arquitetura de Dados - Instructor Workout</title>
  <style>
    :root {
      --bg: #0b1430;
      --panel: #102147;
      --border: #27426f;
      --text: #f9fafb;
      --muted: #cbd5f5;
      --accent-ingest: #38bdf8;
      --accent-lake: #fbbf24;
      --accent-serve: #22c55e;
      --accent-source: #a855f7;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #1d2761 0, #020617 55%, #020617 100%);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--text);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 24px;
    }

    .diagram {
      width: 100%;
      max-width: 1280px;
      background: linear-gradient(135deg, #111827 0, #020617 40%, #020617 100%);
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      box-shadow: 0 24px 80px rgba(15, 23, 42, 0.9);
      padding: 20px 26px 26px;
    }

    .diagram-header {
      text-align: center;
      margin-bottom: 18px;
    }

    .diagram-header h1 {
      font-size: 22px;
      letter-spacing: 0.24em;
      text-transform: uppercase;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    .diagram-header h2 {
      font-size: 24px;
      font-weight: 600;
    }

    .diagram-header p {
      margin-top: 6px;
      font-size: 13px;
      color: var(--muted);
    }

    /* Linha principal do fluxo */
    .flow-line {
      position: relative;
      margin: 18px 0 0;
      height: 3px;
      background-image: linear-gradient(
        90deg,
        rgba(148, 163, 184, 0.1),
        rgba(148, 163, 184, 0.9),
        rgba(148, 163, 184, 0.1)
      );
      background-size: 10px 3px;
      background-repeat: repeat-x;
      opacity: 0.7;
    }

    .pipeline {
      margin-top: 18px;
      display: grid;
      grid-template-columns: 1.1fr 1.1fr 1.4fr 1.2fr;
      gap: 16px;
    }

    .stage {
      background: var(--panel);
      border-radius: 18px;
      border: 1px solid var(--border);
      padding: 10px 12px 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      position: relative;
    }

    .stage-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 4px;
    }

    .stage-title {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      white-space: nowrap;
    }

    .stage-pill {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--muted);
    }

    .stage.sources .stage-title    { color: var(--accent-source); }
    .stage.ingest .stage-title     { color: var(--accent-ingest); }
    .stage.lake .stage-title       { color: var(--accent-lake); }
    .stage.serving .stage-title    { color: var(--accent-serve); }

    .item {
      background: rgba(15, 23, 42, 0.85);
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      padding: 8px 9px;
      font-size: 11px;
      color: var(--muted);
      line-height: 1.4;
    }

    .item-title {
      font-weight: 600;
      font-size: 11px;
      margin-bottom: 2px;
      color: var(--text);
    }

    .item ul {
      margin-top: 3px;
      margin-left: 12px;
    }

    .item li {
      margin-top: 2px;
    }

    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
    }

    .badge {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      padding: 2px 6px;
      font-size: 9px;
      color: var(--muted);
      white-space: nowrap;
    }

    /* Camadas do Data Lake: Bronze → Silver → Gold na horizontal */
    .lake-layers {
      display: flex;
      margin-top: 4px;
      gap: 6px;
      align-items: stretch;
    }

    .lake-layer {
      flex: 1;
      border-radius: 12px;
      padding: 6px 7px;
      font-size: 10px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(248, 250, 252, 0.15);
    }

    .lake-layer h4 {
      font-size: 10px;
      font-weight: 700;
      margin-bottom: 2px;
    }

    .lake-layer.bronze h4 { color: #f97316; }
    .lake-layer.silver h4 { color: #e5e7eb; }
    .lake-layer.gold   h4 { color: #facc15; }

    .lake-flow {
      margin-top: 4px;
      font-size: 10px;
      text-align: center;
      color: var(--muted);
    }

    .lake-flow span {
      font-weight: 600;
      color: #fbbf24;
    }

    /* Responsivo */
    @media (max-width: 1024px) {
      .diagram {
        padding: 16px;
      }
      .pipeline {
        grid-template-columns: 1fr 1fr;
      }
    }

    @media (max-width: 720px) {
      body { padding: 12px; }
      .pipeline {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="diagram">
    <div class="diagram-header">
      <h1>INSTRUCTOR WORKOUT</h1>
      <h2>Arquitetura de Dados – Data Lake em S3</h2>
      <p>Fluxo de dados claro: Fontes &rarr; Airflow &rarr; Data Lake (Bronze → Silver → Gold) &rarr; App / IA / BI.</p>
    </div>

    <div class="flow-line"></div>

    <div class="pipeline">
      <!-- FONTES DE DADOS -->
      <section class="stage sources">
        <div class="stage-header">
          <div class="stage-title">Fontes de Dados</div>
          <div class="stage-pill">Entrada</div>
        </div>

        <div class="item">
          <div class="item-title">API Hevy</div>
          <ul>
            <li>Workouts, séries, exercícios reais.</li>
            <li>Histórico de treinos por usuário.</li>
          </ul>
        </div>

        <div class="item">
          <div class="item-title">Formulário Streamlit</div>
          <ul>
            <li>Perfil, objetivo, experiência de treino.</li>
          </ul>
        </div>

        <div class="item">
          <div class="item-title">Kaggle + Dados Sintéticos</div>
          <ul>
            <li>Catálogo de exercícios, grupos musculares.</li>
            <li>Dados fake para testes do app.</li>
          </ul>
        </div>
      </section>

      <!-- INGESTÃO & ORQUESTRAÇÃO -->
      <section class="stage ingest">
        <div class="stage-header">
          <div class="stage-title">Ingestão &amp; Orquestração</div>
          <div class="stage-pill">Airflow</div>
        </div>

        <div class="item">
          <div class="item-title">DAG instructor_workout_pipeline</div>
          <ul>
            <li><strong>create_lake_structure</strong> cria diretórios Bronze/Silver/Gold/Test no S3.</li>
            <li>Execução batch, agendada.</li>
          </ul>
        </div>

        <div class="item">
          <div class="item-title">Tasks de Ingestão (Camada Bronze)</div>
          <ul>
            <li><strong>ingest_users_form</strong> &mdash; dados do formulário.</li>
            <li><strong>ingest_hevy / ingest_hevy_base</strong> &mdash; treinos da API Hevy.</li>
            <li><strong>ingest_kaggle</strong> &mdash; conjuntos auxiliares Kaggle.</li>
          </ul>
          <div class="badge-row">
            <span class="badge">CSV / Parquet</span>
            <span class="badge">Dados brutos</span>
          </div>
        </div>
      </section>

      <!-- DATA LAKE EM S3 -->
      <section class="stage lake">
        <div class="stage-header">
          <div class="stage-title">Data Lake em S3</div>
          <div class="stage-pill">Bronze · Silver · Gold</div>
        </div>

        <div class="item">
          <div class="item-title">Camadas do Lake</div>
          <div class="lake-layers">
            <div class="lake-layer bronze">
              <h4>Bronze</h4>
              <p>Dados crus, exatamente como vêm das fontes para rastreabilidade.</p>
            </div>
            <div class="lake-layer silver">
              <h4>Silver</h4>
              <p>Dados limpos e padronizados para uso analítico.</p>
            </div>
            <div class="lake-layer gold">
              <h4>Gold</h4>
              <p>Tabelas de negócio e métricas (star schema).</p>
            </div>
          </div>
          <div class="lake-flow">
            Fluxo de transformação: <span>Bronze &rarr; Silver &rarr; Gold</span>
          </div>
        </div>

        <div class="item">
          <div class="item-title">Transformações Silver</div>
          <ul>
            <li><strong>silver_users</strong> &mdash; normalização e deduplicação de usuários.</li>
            <li><strong>silver_transform</strong> &mdash; workouts/sets com volume (carga × reps).</li>
            <li><strong>silver_kaggle</strong> &mdash; tabelas auxiliares limpas.</li>
          </ul>
        </div>

        <div class="item">
          <div class="item-title">Camada Gold (gold_metrics)</div>
          <ul>
            <li><strong>fact_workout_metrics</strong> + dimensões (data, usuário, exercício).</li>
            <li>Volume semanal/mensal, PRs, consistência de treinos.</li>
          </ul>
        </div>
      </section>

      <!-- CONSUMO & ANALYTICS -->
      <section class="stage serving">
        <div class="stage-header">
          <div class="stage-title">Consumo &amp; Analytics</div>
          <div class="stage-pill">App / IA / BI</div>
        </div>

        <div class="item">
          <div class="item-title">App Streamlit</div>
          <ul>
            <li>Leitura da camada Gold para painel de treinos.</li>
            <li>Formulário de perfil e visualização de evolução.</li>
          </ul>
        </div>

        <div class="item">
          <div class="item-title">Chat de IA &ndash; Personal Trainer</div>
          <ul>
            <li>Modelo LLaMA 3.1 via GROQ.</li>
            <li>Recomendações com base nas métricas do usuário.</li>
          </ul>
        </div>

        <div class="item">
          <div class="item-title">Dashboards / BI</div>
          <ul>
            <li>Visão de volume por grupo muscular e período.</li>
            <li>Análises comparativas entre usuários e médias globais.</li>
          </ul>
        </div>
      </section>
    </div>
  </div>
</body>
</html>
